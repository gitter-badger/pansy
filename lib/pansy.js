/*! pansy.js v0.7.8 UTC:2016-02-03 06:43:59 */
!function(b,a){if("function"==typeof define&&define.amd)define([],function(){return b.pansy=a()});else if("object"==typeof exports){var c=a();module.exports=c,"undefined"!=typeof window&&(window.pansy=c)}else b.pansy=a()}(this,function(){var a=function(c){function a(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return c[d].call(e.exports,e,e.exports,a),e.loaded=!0,e.exports}var b={};return a.m=c,a.c=b,a.p="",a(0)}([function(i,n){function j(){return a.__hasInit?!1:(a.__hasInit=!0,"undefined"!=typeof window.onpopstate&&window.addEventListener("popstate",k,!1),void("undefined"!=typeof document.addEventListener?document.addEventListener("click",c,!1):"undefined"!=typeof document.attachEvent?document.attachEvent("onclick",c):document.onclick=c))}function k(d){if(a.__mainAppInit){var c=a.__mainApp;c.state.spa&&b(c.state.curUrl).beforeHash()!=b(location.href).beforeHash()&&c.go(location.href,"replace")}}function c(c){function d(a){if(a!=document.body&&null!=a)if("A"==a.nodeName){if("undefined"!=typeof a.attributes.href){var b=a.attributes.href.value;f(b),g(b)}}else d(a.parentNode)}function f(a){"#"!=a.substr(0,1)&&(b(location.href).href==b(a).href?e(a):b(location.href).beforeHash()==b(a).beforeHash()?""==b(a).hash&&(c.preventDefault(),console.log("为了防止浏览器默认的刷新处理")):b(location.href).origin()==b(a).origin()&&e(a))}function g(d){var f=b(d).hash;if(""!=b(d).hash){var e=f.split("/");e.length>1&&"undefined"!=typeof a.__pluginApps[e[1]]&&(c.preventDefault(),a.__pluginApps[e[1]].go(d,"replace"))}}function e(b){c.preventDefault(),console.info("开始解析:"+b),a.__mainApp.go(b,"push")}a.__mainAppInit?a.__mainApp.state.spa&&d(c.target):a.__hasPlugins&&d(c.target)}function e(c){var a={state:{isPlugin:!1,complete:!0,prevUrl:null,curUrl:location.href,timeout:6e4,mode:!1,routeQuery:null,routeScope:"",spa:!1,protocol:null},stack:[],set:function(a,b){var c=this;return"undefined"!=typeof b&&(c.state[a]=b),c.state[a].toString()||void 0},use:function(){var b=this;if(1==arguments.length)if("function"==typeof arguments[0]){var c={fn:arguments[0]};c.isErrorHandle=f(c.fn),b.stack.push(c)}else if(arguments[0]instanceof Array){var e=arguments[0];d(e,function(a,c){"function"==typeof a?b.use(a):a instanceof Array&&2==a.length?b.use(a[0],a[1]):(console.warn("use参数有误"),console.warn(a))})}else arguments[0]instanceof Object?arguments[0].__stack instanceof Array?b.use(arguments[0].__stack):console.warn("use router 时参数有误"):console.warn("use参数异常");else if(2==arguments.length){var a=arguments[0];a instanceof Array?a=new RegExp("(^"+a.join("$)|(^")+"$)"):"string"==typeof a&&(a=new RegExp("^"+a+"$")),!a instanceof RegExp&&console.error("route参数错误: "+a),b.stack.push({fn:arguments[1],path:a,isErrorHandel:f(arguments[1])})}},route:function(a){var b=this;return{get:function(){var c=Array.prototype.slice.call(arguments,0);d(c,function(c,d){b.use(a,c)})}}},go:function(n,p){function e(b){return o?console.error("next异常"):(c++,c>=a.stack.length?(g.length&&console.error(g),d.routed||console.error("404 not found"),k.end()):(b&&g.push(b),g.length?a.stack[c].isErrorHandle?(a.stack[c].fn(g,d,k,e),g=[]):e():"undefined"!=typeof a.stack[c].disabled?e():"undefined"!=typeof a.stack[c].path?m(d,a.stack[c].path)?(a.stack[c].fn(d,k,e),d.routed=!0):e():void a.stack[c].fn(d,k,e)))}j();var a=this;if(!a.state.complete)return!1;a.state.complete=!1;var f=b(n||location.href).all(),i="/";a.state.isPlugin?n.length>0&&n.match(new RegExp("^#/"+a.state.pluginName))&&(i=n.substring(a.state.pluginName.length+2)||"/"):a.state.routeQuery?i=f.query[a.state.routeQuery]||"/":(f.pathname.match(new RegExp("^"+a.state.routeScope))&&(i=f.pathname.substr(a.state.routeScope.length)||"/"),f.params=l(i.replace(/^\//,"").split("/"),"")),f.filterPath=i,console.info("请求地址: "+f.filterPath);var d=h(f,{routed:!1,expire:(new Date).getTime()+a.state.timeout,conf:a.state,state:a.state,historyStateType:p||"push"}),k={end:function(){o=!0,a.state.complete=!0,a.state.errorStack=null,console.info("请求结束"),a.state.spa&&"file:"!=a.state.protocol&&(console.log("spa: "+a.state.spa),"replace"==d.historyStateType?history.replaceState("data","title",d.rawUrl):history.pushState("data","title",d.rawUrl))},redirect:function(b){k.end(),a.state.spa?a.go(a.state.routeScope):location.href=a.state.routeScope+b}},o=!1,g=[],c=-1;e()}};return a.state=h(a.state,c),a}function f(a){try{return 4==a.toString().match(/[A-Z0-9a-z,(\s]*\)/)[0].split(",").length}catch(b){return!1}}function m(a,b){try{return a.filterPath.match(b)[0]==a.filterPath}catch(c){return!1}}function b(e){function f(){return a.href.replace(/#.*/,"")}function b(){var b=a.pathname||"/"+a.pathname;return b.replace(/^([^\/])/,"/$1")}function c(){for(var d={},c=a.search.replace(/^\?/,"").split("&"),f=c.length,b=0;f>b;b++)if(c[b]){var e=c[b].split("=");d[e[0]]=e[1]}return d}function d(){if("undefined"!=typeof a.origin)return a.origin;var b=a.protocol+"//"+a.hostname;return""==a.port?b:"80"==a.port&&"http:"==a.protocol?b:"443"==a.port&&"https"==a.protocol?b:b+=":"+a.port}var a=document.createElement("a");return a.href=e,{rawUrl:a.href,href:a.href,hash:a.hash,port:a.port,protocol:a.protocol,pathname:b,query:c,origin:d,beforeHash:f,all:function(){return{port:a.port,protocol:a.protocol,hostname:a.hostname,pathname:b(),query:c(),origin:d()}}}}function d(a,c){var d={};for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&"function"==typeof c&&(d[b]=c.call(a,a[b],b,a));return d}function g(b,c){var d=b.length;if("function"!=typeof c)throw new TypeError;for(var a=0;d>a;a++)a in b&&c.call(arguments[1],b[a],a,b)}function h(){var a={},b=Array.prototype.slice.call(arguments,0);return g(b,function(b,d){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}),a}function l(b,c){var a=[];return g(b,function(b){b!==c&&a.push(b)}),a}var a=i.exports={__hasInit:!1,__mainAppInit:!1,__hasPlugins:!1,__mainApp:{},__pluginApps:{},__onpopstate:!1,__onanchorclick:!1,createMain:function(b){return this.__mainAppInit?this.__mainApp:(a.__mainAppInit=!0,this.__mainApp=e(b))},createPlugin:function(b){return a.__hasPlugins=!0,"undefined"!=typeof this.__pluginApps[b.pluginName]?this.__pluginApps[b.pluginName]:(b.isPlugin=!0,this.__pluginApps[b.pluginName]=e(b),this.__pluginApps[b.pluginName])},createRouter:function(){var a=[];return{__stack:a,use:function(b){a.push(b)},route:function(b){return{get:function(){var c=Array.prototype.slice.call(arguments,0);d(c,function(c,d){a.push([b,c])})}}}}}};a.Plugin=a.createPlugin,a.Main=a.createMain,a.Master=a.createMain,a.Router=a.createRouter}]);return a});